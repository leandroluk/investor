 erDiagram
    %% MODULE: account
    challenge {
        uuidv7       id         PK
        timestamp[3] created_at ""
        timestamp[3] updated_at ""
        uuidv7       user_id    FK
        varchar[50]  type       ""
        varchar[255] code       ""
        varchar[20]  status     ""
        timestamp[3] expires_at ""
    }    
    device {
        uuidv7       id          PK
        timestamp[3] created_at  ""
        timestamp[3] updated_at  ""
        uuidv7       user_id     FK
        varchar[20]  platform    ""
        varchar[255] fingerprint ""
        boolean      is_active   ""
        varchar[50]  brand       ""
        varchar[50]  name        ""
        varchar[50]  model       ""
    }
    document {
        uuidv7       id            PK
        timestamp[3] created_at    ""
        timestamp[3] updated_at    ""
        uuidv7       user_id       FK
        varchar[50]  type          ""
        varchar[255] storage_key   ""
        varchar[20]  status        ""
        null[text]   reject_reason ""
    }    
    login {
        uuidv7       id         PK
        timestamp[3] created_at ""
        uuidv7       user_id    FK
        varchar[50]  ip         ""
        boolean      success    ""
    }
    user {
        uuidv7             id                    PK
        timestamp[3]       created_at            ""
        timestamp[3]       updated_at            ""
        null[timestamp[3]] deleted_at            ""
        varchar[100]       email                 UK
        text               password_hash         ""
        varchar[100]       name                  ""
        varchar[20]        status                ""
        null[char[42]]     wallet_address        UK
        null[timestamp[3]] wallet_verified_at    ""
        null[text]         wallet_seed_encrypted ""
        varchar[20]        kyc_status            ""
        null[timestamp[3]] kyc_verified_at       ""
        boolean            two_factor_enabled    ""
        varchar[10]        language              ""
        varchar[100]       timezone              ""  
    }

    %% MODULE: audit
    ledger {
        uuidv7       id           PK
        timestamp[3] created_at   ""
        uuidv7       user_id      FK
        varchar[50]  type         "" 
        decimal      amount_usd   ""
        uuidv7       reference_id ""
    }

    %% MODULE: catalog
    asset {
        uuidv7             id         PK
        timestamp[3]       created_at ""
        null[timestamp[3]] deleted_at ""
        varchar[50]        slug       ""
        varchar[10]        symbol     ""
        varchar[50]        network    ""
        boolean            is_active  ""
    }
    strategy {
        uuidv7             id                      PK
        timestamp[3]       created_at              ""
        timestamp[3]       updated_at              ""
        null[timestamp[3]] deleted_at              ""
        varchar[50]        alias                   ""
        text               description             ""
        decimal            expected_apy_range_low  ""
        decimal            expected_apy_range_high ""
    }

    %% MODULE: portfolio
    earning {
        uuidv7       id            PK
        timestamp[3] created_at    ""
        uuidv7       investment_id FK
        decimal      amount_token  ""
        decimal      amount_usd    ""
    }
    investment {
        uuidv7       id          PK
        timestamp[3] created_at  ""
        timestamp[3] updated_at  ""
        uuidv7       strategy_id FK
        uuidv7       asset_id    FK
        uuidv7       user_id     FK
        decimal      amount_usd  ""
        varchar[20]  status      ""
    }

    %% MODULE: signal
    notice {
        uuidv7       id         PK
        timestamp[3] created_at ""
        uuidv7       user_id    FK
        varchar[150] title      ""
        boolean      is_read    ""
    }

    %% MODULE: support
    ticket {
        uuidv7       id         PK
        timestamp[3] created_at ""
        timestamp[3] updated_at ""
        uuidv7       user_id    FK
        varchar[150] subject    ""
        text         message    ""
        varchar[20]  status     ""
    }

    %% MODULE: system
    config {
        uuidv7       id           PK
        timestamp[3] created_at   ""
        timestamp[3] updated_at   ""
        varchar[100] key          UK
        text         value        ""
    }

    %% MODULE: treasury
    withdrawal {
        uuidv7       id               PK
        timestamp[3] created_at       ""
        timestamp[3] updated_at       ""
        uuidv7       user_id          FK
        decimal      amount_usd       ""
        varchar[20]  status           ""
        char[66]     transaction_hash ""
    }

    user       ||--o{ device     : "has"
    user       ||--o{ challenge  : "has"
    user       ||--o{ login      : "logs"
    user       ||--o{ notice     : "receives"
    user       ||--o{ document   : "uploads"
    investment }o--|| user       : "owns"
    withdrawal }o--|| user       : "requests"
    ticket     }o--|| user       : "opens"
    ledger     }o--|| user       : "records"
    strategy   ||--o{ investment : "defines"
    asset      ||--o{ investment : "denominates"
    investment ||--o{ earning    : "generates"